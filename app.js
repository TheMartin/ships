!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=27)}([function(t,e,n){"use strict";var i=function(){function t(t){this.pos=t}return t.t="Position",t}();e.Position=i;var o=function(){function t(t){this.angle=t}return t.t="Rotation",t}();e.Rotation=o},function(t,e,n){"use strict";function i(t,e){return t.x*e.x+t.y*e.y}function o(t){return i(t,t)}function r(t){return Math.sqrt(o(t))}function s(t,e){return o(t.clone().subtract(e))}function a(t,e){return Math.sqrt(s(t,e))}function c(t,e,n){return(1-n)*t+n*e}var u=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},t.prototype.elementMultiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.elementDivide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=function(){return this.multiply(1/r(this))},t.prototype.normalized=function(){return this.clone().normalize()},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,o=n*this.x+e*this.y;return this.x=i,this.y=o,this},t.prototype.rotated=function(t){return this.clone().rotate(t)},t.prototype.angle=function(){return Math.atan2(this.x,-this.y)},t.lerp=function(t,e,n){return t.clone().multiply(1-n).add(e.clone().multiply(n))},t.random=function(){return new t(Math.random(),Math.random())},t.zero=new t(0,0),t}();e.Vec2=u,e.dot=i,e.norm2=o,e.norm=r,e.distance2=s,e.distance=a,e.lerp=c},function(t,e,n){"use strict";var i=function(){function t(){}return t.t="Cached",t}();e.Cached=i},function(t,e,n){"use strict";function i(t,e,n){var i=t.pos;return e&&e.value&&(i=a.Vec2.lerp(e.value.pos,i,n)),i}function o(t,e,n){var i=t.angle;return e&&e.value&&(i=a.lerp(e.value.angle,i,n)),i}var r=n(0),s=n(2),a=n(1),c=function(){function t(t){this.entities=t}return t.prototype.update=function(t){this.entities.forEachEntity([r.Position.t,s.Cached.t+r.Position.t],function(t,e){var n=e,i=n[0];n[1].value=new r.Position(i.pos.clone())})},t}();e.CachePosition=c,e.interpolatePosition=i;var u=function(){function t(t){this.entities=t}return t.prototype.update=function(t){this.entities.forEachEntity([r.Rotation.t,s.Cached.t+r.Rotation.t],function(t,e){var n=e,i=n[0];n[1].value=new r.Rotation(i.angle)})},t}();e.CacheRotation=u,e.interpolateRotation=o},function(t,e,n){"use strict";function i(t,e){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y}function o(t){return void 0!==t.box}var r=n(7),s=n(2),a=n(0),c=n(6),u=n(3),h=n(1),l=function(){function t(){}return t.t="Selectable",t}();e.Selectable=l;var p=function(){function t(){}return t.t="Selected",t}();e.Selected=p;var d=function(){function t(t,e){this.min=new h.Vec2(Math.min(t.x,e.x),Math.min(t.y,e.y)),this.max=new h.Vec2(Math.max(t.x,e.x),Math.max(t.y,e.y))}return t}(),f=function(){function t(t){this.box=t}return t}(),v=function(){function t(){}return t}(),y=function(){function t(t,e,n,i,o){var s=this;this.entities=t,this.player=e,this.ui=n,this.renderer=i,this.viewport=o,n.addEventListener("dragstart",function(t){t.button===r.MouseButton.Left&&(s.dragStart=s.viewport.inverseTransform(t.pos))}),n.addEventListener("dragend",function(t){t.button===r.MouseButton.Left&&(s.selection=new f(new d(s.viewport.transform(s.dragStart),s.dragCurrent)),s.dragStart=null,s.dragCurrent=null)}),n.addEventListener("click",function(t){t.button===r.MouseButton.Left&&(s.selection=new v)}),n.addEventListener("entityclick",function(t){t.button===r.MouseButton.Left&&s.entities.forEachEntity([l.t,c.Controlled.t],function(e,n){var i=n;i[0];if(i[1].player===s.player){var o=e.getOptionalComponents([p.t])[0];o||e!==t.entities[0]?o&&e!==t.entities[0]&&e.removeComponent(p.t):e.addComponent(p.t,new p)}})})}return t.prototype.update=function(e,n){var r=this;if(this.selection&&(o(this.selection)?this.entities.forEachEntity([a.Position.t,l.t,c.Controlled.t],function(t,e){var o=e,c=o[0];if(o[2].player===r.player){var h=t.getOptionalComponents([s.Cached.t+a.Position.t,p.t]),l=h[0],d=h[1],f=i(r.viewport.transform(u.interpolatePosition(c,l,n)),r.selection.box);!d&&f?t.addComponent(p.t,new p):d&&!f&&t.removeComponent(p.t)}}):this.entities.forEachEntity([],function(t,e){t.removeComponent(p.t)}),this.selection=null),this.entities.forEachEntity([p.t,a.Position.t],function(e,i){var o=i,c=o[1],l=r.viewport.transform(u.interpolatePosition(c,e.components[s.Cached.t+a.Position.t],n)),p=new h.Vec2(10,10).multiply(r.viewport.scale);r.renderer.drawRect(l.clone().subtract(p),l.clone().add(p),t.selectedBoxProps)}),this.dragStart){this.ui.mousePosition()&&(this.dragCurrent=this.ui.mousePosition().clone()),this.dragCurrent&&this.renderer.drawRect(this.viewport.transform(this.dragStart),this.dragCurrent,t.selectionBoxProps)}},t.selectedBoxProps={stroke:"rgb(0, 255, 0)"},t.selectionBoxProps={stroke:"rgb(0, 255, 0)",lineWidth:1,fillColor:"rgba(0, 255, 0, 0.2)"},t}();e.SelectionSystem=y},function(t,e,n){"use strict";var i=n(0),o=n(1),r=function(){function t(){}return t.t="MoveToTarget",t}();e.MoveToTarget=r;var s=function(){function t(t,e){this.entities=t,this.speed=e}return t.prototype.update=function(t){var e=this;this.entities.forEachEntity([i.Position.t,i.Rotation.t,r.t],function(n,i){var r=i,s=r[0],a=r[1],c=r[2];if(c.target){var u=c.target.clone().subtract(s.pos);o.norm2(u)>.5?(a.angle=u.angle(),s.pos.add(u.normalized().multiply(Math.min(o.norm(u),e.speed*t)))):c.target=null}})},t}();e.MoveTo=s},function(t,e,n){"use strict";!function(t){t[t.Local=0]="Local",t[t.Ai=1]="Ai",t[t.Remote=2]="Remote"}(e.PlayerType||(e.PlayerType={}));var i=(e.PlayerType,function(){function t(t){this.type=t}return t}());e.Player=i;var o=function(){function t(t){this.player=t}return t.t="Controlled",t}();e.Controlled=o},function(t,e,n){"use strict";function i(t){return t}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(9),s=n(1);!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Count=3]="Count"}(e.MouseButton||(e.MouseButton={}));var a,c=e.MouseButton;!function(t){t[t.Up=0]="Up",t[t.Clicked=1]="Clicked",t[t.Dragged=2]="Dragged"}(a||(a={}));!function(t){var e=function(){function t(){}return t}();t.EntityClick=e;var n=function(){function t(){}return t}();t.MouseEvent=n;var i=function(t){function e(){t.apply(this,arguments)}return o(e,t),e}(n);t.MouseClick=i;var r=function(t){function e(){t.apply(this,arguments)}return o(e,t),e}(n);t.MouseDragStart=r;var s=function(t){function e(){t.apply(this,arguments)}return o(e,t),e}(n);t.MouseDragEnd=s;var a=function(){function t(){}return t}();t.MouseMove=a}(e.Events||(e.Events={}));var u=function(){function t(t,e,n){var o=this;this.entities=t,this.rootElement=e,this.canvas=n,this.mouseButtons=[a.Up,a.Up,a.Up],this.mousePos=new s.Vec2(0,0),this.listeners={entityclick:[],click:[],mousemove:[],dragstart:[],dragend:[]},this.mousePos=new s.Vec2(this.canvas.width/2,this.canvas.height/2),n.addEventListener("mousedown",function(t){o.mouseButtons[i(t.button)]=a.Clicked}),n.addEventListener("mouseup",function(t){var e=new s.Vec2(t.clientX,t.clientY),n=i(t.button);if(o.mouseButtons[n]===a.Clicked){var c=o.entities.filterEntities([r.Clickable.t],function(t,n){var i=n[0];return i.pos&&s.distance(i.pos,e)<5});c.length>0?o.invokeListeners("entityclick",{entities:c,button:n}):o.invokeListeners("click",{pos:e,button:n})}else o.mouseButtons[n]===a.Dragged&&o.invokeListeners("dragend",{pos:e,button:n});o.mouseButtons[n]=a.Up}),e.addEventListener("mouseenter",function(t){o.mousePos=new s.Vec2(t.clientX,t.clientY)}),e.addEventListener("mouseleave",function(t){o.mousePos=null}),e.addEventListener("mousemove",function(t){var e=o.mousePos.clone(),n=e.clone().subtract(new s.Vec2(t.clientX,t.clientY));o.mousePos.x=t.clientX,o.mousePos.y=t.clientY,o.invokeListeners("mousemove",{pos:o.mousePos.clone(),delta:n});for(var i=c.Left;i<c.Count;++i)o.mouseButtons[i]===a.Clicked&&(o.invokeListeners("dragstart",{pos:e,button:i}),o.mouseButtons[i]=a.Dragged)})}return t.prototype.addEventListener=function(t,e){var n=t.toLowerCase();n in this.listeners&&this.listeners[n].push(e)},t.prototype.removeEventListener=function(t,e){var n=t.toLowerCase();if(n in this.listeners){var i=this.listeners[n].indexOf(e);i>-1&&this.listeners[n].splice(i,1)}},t.prototype.addElement=function(t){this.rootElement.appendChild(t)},t.prototype.removeElement=function(t){this.rootElement.removeChild(t)},t.prototype.canvasWidth=function(){return this.canvas.width},t.prototype.canvasHeight=function(){return this.canvas.height},t.prototype.mousePosition=function(){return this.mousePos},t.prototype.invokeListeners=function(t,e){if(t in this.listeners)for(var n=0,i=this.listeners[t];n<i.length;n++){var o=i[n];o(e)}},t}();e.UiManager=u},function(t,e,n){"use strict";var i=function(){function t(){}return t.t="Targetable",t}();e.Targetable=i;var o=function(){function t(){this.target=null}return t.t="AttackTarget",t}();e.AttackTarget=o},function(t,e,n){"use strict";var i=n(0),o=n(2),r=n(3),s=function(){function t(){}return t.t="Clickable",t}();e.Clickable=s;var a=function(){function t(t,e){this.entities=t,this.viewport=e}return t.prototype.update=function(t,e){var n=this;this.entities.forEachEntity([s.t,i.Position.t],function(t,s){var a=s,c=a[0],u=a[1],h=t.getOptionalComponents([o.Cached.t+i.Position.t])[0];c.pos=n.viewport.transform(r.interpolatePosition(u,h,e))})},t}();e.UpdateClickable=a},function(t,e,n){"use strict";var i=n(1),o=function(){function t(t,e,n){this.pos=t,this.rot=e,this.scale=n}return t.prototype.transform=function(t){return t.rotated(this.rot).multiply(this.scale).add(this.pos)},t.prototype.inverseTransform=function(t){return t.clone().subtract(this.pos).multiply(1/this.scale).rotate(-this.rot)},t.identity=new t(i.Vec2.zero,0,1),t}();e.Viewport=o;var r=function(){function t(t){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.ctx.lineJoin="round",this.ctx.lineCap="round"}return t.prototype.drawShape=function(t,e,n,i,r){void 0===r&&(r=o.identity),this.setTransform(r.transform(e),n+r.rot,i*r.scale),this.setProps(t.props),this.ctx.beginPath(),this.ctx.moveTo(t.vertices[0].x,t.vertices[0].y);for(var s=1;s<t.vertices.length;++s)this.ctx.lineTo(t.vertices[s].x,t.vertices[s].y);this.ctx.closePath(),this.render(t.props)},t.prototype.drawLine=function(t,e,n,i){void 0===n&&(n={}),void 0===i&&(i=o.identity),this.setViewport(i),this.setProps(n);var r=[];n.lineDash&&(r=this.ctx.getLineDash(),this.ctx.setLineDash(n.lineDash)),this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.render(n),n.lineDash&&this.ctx.setLineDash(r)},t.prototype.drawRect=function(t,e,n,i){void 0===n&&(n={}),void 0===i&&(i=o.identity),this.setViewport(i),this.setProps(n);var r=Math.min(t.x,e.x),s=Math.min(t.y,e.y),a=Math.abs(e.x-t.x),c=Math.abs(e.y-t.y);n.fillColor&&this.ctx.fillRect(r,s,a,c),n.stroke&&this.ctx.strokeRect(r,s,a,c)},t.prototype.drawCircle=function(t,e,n,i){void 0===n&&(n={}),void 0===i&&(i=o.identity),this.setViewport(i),this.setProps(n),this.ctx.beginPath(),this.ctx.arc(t.x,t.y,e,0,2*Math.PI),this.ctx.closePath(),this.render(n)},t.prototype.clear=function(){this.setIdentityTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.setProps=function(t){t.fillColor&&(this.ctx.fillStyle=t.fillColor),t.stroke&&(this.ctx.strokeStyle=t.stroke,t.lineWidth&&(this.ctx.lineWidth=t.lineWidth))},t.prototype.render=function(t){t.fillColor&&this.ctx.fill(),t.stroke&&this.ctx.stroke()},t.prototype.setViewport=function(t){t==o.identity?this.setIdentityTransform():this.setTransform(t.pos,t.rot,t.scale)},t.prototype.setIdentityTransform=function(){this.ctx.setTransform(1,0,0,1,0,0)},t.prototype.setTransform=function(t,e,n){var i=n*Math.cos(e),o=n*Math.sin(e);this.ctx.setTransform(i,o,-o,i,t.x,t.y)},t}();e.Renderer=r},function(t,e,n){"use strict";var i=function(){function t(){this.components={},this.id=t.Count,t.Count+=1}return t.prototype.addComponent=function(t,e){return this.components[t]=e,this},t.prototype.removeComponent=function(t){return delete this.components[t],this},t.prototype.getComponents=function(t){for(var e=[],n=0,i=t;n<i.length;n++){var o=i[n];if(!this.components[o])return null;e.push(this.components[o])}return e},t.prototype.getOptionalComponents=function(t){for(var e=[],n=0,i=t;n<i.length;n++){var o=i[n];this.components[o]&&e.push(this.components[o])}return e},t.Count=0,t}();e.Entity=i;var o=function(){function t(){this.entities={}}return t.prototype.addEntity=function(t){this.entities[t.id]=t},t.prototype.removeEntity=function(t){delete this.entities[t.id]},t.prototype.forEachEntity=function(t,e){for(var n in this.entities){var i=this.entities[n],o=i.getComponents(t);o&&e(i,o)}},t.prototype.findEntity=function(t,e){for(var n in this.entities){var i=this.entities[n],o=i.getComponents(t);if(o&&e(i,o))return i}return null},t.prototype.filterEntities=function(t,e){var n=[];for(var i in this.entities){var o=this.entities[i],r=o.getComponents(t);r&&e(o,r)&&n.push(o)}return n},t}();e.EntityContainer=o},function(t,e,n){"use strict";var i=function(){function t(t){this.name=t}return t.t="Named",t}();e.Named=i},function(t,e,n){"use strict";var i=n(0),o=n(2),r=n(3),s=function(){function t(t){this.shape=t}return t.t="RenderShape",t}();e.RenderShape=s;var a=function(){function t(t,e,n){this.entities=t,this.renderer=e,this.viewport=n}return t.prototype.update=function(t,e){var n=this;this.entities.forEachEntity([s.t,i.Position.t],function(t,s){var a=s,c=a[0],u=a[1],h=t.getOptionalComponents([i.Rotation.t,o.Cached.t+i.Position.t,o.Cached.t+i.Rotation.t]),l=h[0],p=h[1],d=h[2];n.renderer.drawShape(c.shape,r.interpolatePosition(u,p,e),l?r.interpolateRotation(l,d,e):0,1,n.viewport)})},t}();e.ShapeRenderer=a},function(t,e,n){"use strict";var i=n(11),o=n(3),r=n(5),s=n(20),a=n(22),c=n(19),u=n(4),h=n(13),l=n(23),p=n(24),d=n(6),f=n(21),v=n(18),y=n(9),m=n(7),g=n(10),w=n(1),C=n(16),x=n(25),E=function(){function t(t,e,n){this.renderer=n,this.lastUpdate=0,this.lastDraw=0,this.fps=0,this.entityContainer=new i.EntityContainer,this.updateSystems=[],this.renderSystems=[],this.viewport=g.Viewport.identity,this.players=[],this.ui=new m.UiManager(this.entityContainer,t,e);var C=new d.Player(d.PlayerType.Local),x=new d.Player(d.PlayerType.Ai);this.players=[C,x],this.updateSystems=[new o.CachePosition(this.entityContainer),new o.CacheRotation(this.entityContainer),new s.ChooseRandomMoveTarget(this.entityContainer,x,new w.Vec2(0,0),new w.Vec2(1e3,1e3)),new r.MoveTo(this.entityContainer,50)],this.viewport=new g.Viewport(new w.Vec2(0,0),0,1),this.renderSystems=[new y.UpdateClickable(this.entityContainer,this.viewport),new p.ViewportController(this.ui,1e3,this.viewport),new u.SelectionSystem(this.entityContainer,C,this.ui,n,this.viewport),new c.OrderMove(this.entityContainer,C,this.ui,this.viewport),new v.OrderAttack(this.entityContainer,C,this.ui,this.viewport),new a.RenderMoveTarget(this.entityContainer,n,this.viewport),new f.RenderAttackTarget(this.entityContainer,n,this.viewport),new h.ShapeRenderer(this.entityContainer,n,this.viewport),new l.StatusWindow(this.entityContainer,this.ui)]}return t.prototype.start=function(t){var e=this;this.fps=t,this.lastUpdate=performance.now(),this.lastDraw=performance.now();for(var n=function(){setTimeout(n,1e3/e.fps);var t=performance.now(),i=(t-e.lastUpdate)/1e3;e.lastUpdate=t,e.update(i)},i=function(t){requestAnimationFrame(i);var n=(t-e.lastDraw)/1e3;e.lastDraw=t;var o=e.fps*(t-e.lastUpdate)/1e3;e.draw(n,o)},o=new w.Vec2(50,50),r=new w.Vec2(600,600),s=x.shuffle(["Arethusa","Aurora","Galatea","Penelope","Phaeton","Bonaventure","Dido","Argonaut","Scylla","Swiftsure","Minotaur","Bellerophon","Vanguard","Collosus","Audacious","Warspite","Valiant"]),a=0;a<5;++a)this.entityContainer.addEntity(C.Static.makeShip(w.Vec2.random().elementMultiply(r).add(o),0,s[a],C.Static.Ship,this.players[0]));for(var a=5;a<10;++a)this.entityContainer.addEntity(C.Static.makeShip(w.Vec2.random().elementMultiply(r).add(o),0,s[a],C.Static.NeutralShip,this.players[1]));setTimeout(n,1e3/this.fps),requestAnimationFrame(i)},t.prototype.update=function(t){for(var e=0,n=this.updateSystems;e<n.length;e++){n[e].update(t)}},t.prototype.draw=function(t,e){this.renderer.clear();for(var n=0,i=this.renderSystems;n<i.length;n++){i[n].update(t,e)}},t}();e.Game=E},function(t,e){},function(t,e,n){"use strict";var i=n(11),o=n(2),r=n(0),s=n(13),a=n(5),c=n(4),u=n(12),h=n(6),l=n(8),p=n(9),d=n(17),f=n(1),v=function(){function t(){}return t.makeShip=function(t,e,n,d,f){return(new i.Entity).addComponent(r.Position.t,new r.Position(t)).addComponent(r.Rotation.t,new r.Rotation(e)).addComponent(s.RenderShape.t,new s.RenderShape(d)).addComponent(o.Cached.t+r.Position.t,new o.Cached).addComponent(o.Cached.t+r.Rotation.t,new o.Cached).addComponent(a.MoveToTarget.t,new a.MoveToTarget).addComponent(c.Selectable.t,new c.Selectable).addComponent(u.Named.t,new u.Named(n)).addComponent(h.Controlled.t,new h.Controlled(f)).addComponent(l.Targetable.t,new l.Targetable).addComponent(l.AttackTarget.t,new l.AttackTarget).addComponent(p.Clickable.t,new p.Clickable)},t.Box=new d.Shape({stroke:"black",lineWidth:5,fillColor:"gray"},[new f.Vec2(-35,-35),new f.Vec2(-25,25),new f.Vec2(25,25),new f.Vec2(25,-25)]),t.shipVertices=[new f.Vec2(0,-15),new f.Vec2(-12,15),new f.Vec2(0,10.5),new f.Vec2(12,15)],t.Ship=new d.Shape({stroke:"hsla(207, 100%, 60%, 1)",lineWidth:3,fillColor:"hsla(207, 100%, 30%, 0.8)"},t.shipVertices),t.NeutralShip=new d.Shape({stroke:"hsla(120, 100%, 60%, 1)",lineWidth:3,fillColor:"hsla(120, 100%, 30%, 0.8)"},t.shipVertices),t}();e.Static=v},function(t,e,n){"use strict";var i=function(){function t(t,e){this.props=t,this.vertices=e}return t}();e.Shape=i},function(t,e,n){"use strict";var i=n(7),o=n(8),r=n(4),s=n(6),a=function(){function t(t,e,n,a){var c=this;this.entities=t,this.player=e,this.interp=0,n.addEventListener("entityclick",function(t){if(t.button===i.MouseButton.Right)for(var e=function(t){var e=t.getComponents([s.Controlled.t,o.Targetable.t]);if(!e)return"continue";var n=e,i=n[0],a=n[1];return i.player!==c.player?(c.entities.forEachEntity([r.Selected.t,o.AttackTarget.t,s.Controlled.t],function(t,e){var n=e,i=n[1];n[2].player===c.player&&(i.target=a)}),"break"):void 0},n=0,a=t.entities;n<a.length;n++){var u=a[n],h=e(u);if("break"===h)break}})}return t.prototype.update=function(t,e){this.interp=e},t}();e.OrderAttack=a},function(t,e,n){"use strict";var i=n(7),o=n(5),r=n(4),s=n(6),a=function(){function t(t,e,n,a){var c=this;this.entities=t,this.player=e,n.addEventListener("click",function(t){t.button===i.MouseButton.Right&&c.entities.forEachEntity([r.Selected.t,o.MoveToTarget.t,s.Controlled.t],function(e,n){var i=n,o=i[1];i[2].player===c.player&&(o.target=a.inverseTransform(t.pos))})})}return t.prototype.update=function(t,e){},t}();e.OrderMove=a},function(t,e,n){"use strict";var i=n(5),o=n(6),r=n(1),s=function(){function t(t,e,n,i){this.entities=t,this.player=e,this.min=n,this.size=i.clone().subtract(n)}return t.prototype.update=function(t){var e=this;this.entities.forEachEntity([i.MoveToTarget.t,o.Controlled.t],function(t,n){var i=n,o=i[0];i[1].player!==e.player||o.target||(o.target=e.min.clone().add(new r.Vec2(Math.random(),Math.random()).elementMultiply(e.size)))})},t}();e.ChooseRandomMoveTarget=s},function(t,e,n){"use strict";var i=n(8),o=n(4),r=n(0),s=n(2),a=n(3),c=function(){function t(t,e,n){this.entities=t,this.renderer=e,this.viewport=n}return t.prototype.update=function(e,n){var c=this;this.entities.forEachEntity([o.Selected.t,i.AttackTarget.t],function(e,o){var u=o,h=u[1];if(h.target){var l=c.entities.findEntity([i.Targetable.t,r.Position.t],function(t,e){return e[0]===h.target});if(l){var p=l.getComponents([r.Position.t])[0],d=l.getOptionalComponents([s.Cached.t+r.Position.t])[0],f=a.interpolatePosition(p,d,n);c.renderer.drawCircle(f,10,t.targetProps,c.viewport),c.renderer.drawCircle(f,5,t.targetProps,c.viewport);var v=e.getOptionalComponents([r.Position.t,s.Cached.t+r.Position.t]),y=v[0],m=v[1];y&&c.renderer.drawLine(f,a.interpolatePosition(y,m,n),t.targetProps,c.viewport)}}})},t.targetProps={stroke:"rgb(255, 0, 0)",lineWidth:1,lineDash:[1,7]},t}();e.RenderAttackTarget=c},function(t,e,n){"use strict";var i=n(5),o=n(4),r=n(0),s=n(2),a=n(3),c=function(){function t(t,e,n){this.entities=t,this.renderer=e,this.viewport=n}return t.prototype.update=function(e,n){var c=this;this.entities.forEachEntity([o.Selected.t,i.MoveToTarget.t],function(e,i){var o=i,u=o[1];if(u.target){c.renderer.drawCircle(u.target,10,t.targetProps,c.viewport),c.renderer.drawCircle(u.target,5,t.targetProps,c.viewport);var h=e.getOptionalComponents([r.Position.t,s.Cached.t+r.Position.t]),l=h[0],p=h[1];l&&c.renderer.drawLine(a.interpolatePosition(l,p,n),u.target,t.targetProps,c.viewport)}})},t.targetProps={stroke:"rgb(0, 255, 0)",lineWidth:1,lineDash:[5,15]},t}();e.RenderMoveTarget=c},function(t,e,n){"use strict";function i(t){return t.x.toFixed()+" : "+t.y.toFixed()}var o=n(4),r=n(2),s=n(0),a=n(3),c=n(5),u=n(12),h=n(8),l=n(26),p=function(){function t(t,e){this.entities=t,this.ui=e,this.elem=l.VdomElement.create("div",{class:"window"},[]),this.$elem=l.createElement(this.elem)}return t.prototype.update=function(t,e){var n=this,p=l.VdomElement.create("div",{class:"window"},[]);this.entities.forEachEntity([o.Selected.t],function(t,o){var d=t.getOptionalComponents([u.Named.t,s.Position.t,r.Cached.t+s.Position.t,c.MoveToTarget.t,h.AttackTarget.t]),f=d[0],v=d[1],y=d[2],m=d[3],g=d[4],w=[];if(f&&w.push(l.VdomElement.create("span",{class:"name"},[f.name])),v&&w.push(l.VdomElement.create("span",{class:"pos"},[i(a.interpolatePosition(v,y,e))])),m&&m.target&&w.push(l.VdomElement.create("span",{class:"tgt"},[i(m.target)])),g&&g.target){var C=n.entities.findEntity([h.Targetable.t,u.Named.t],function(t,e){return e[0]===g.target});if(C){var x=C.getComponents([u.Named.t])[0];w.push(l.VdomElement.create("span",{class:"atk"},[x.name]))}}p.children.push(l.VdomElement.create("div",{class:"ship"},w))}),l.updateElementChildren(this.$elem,p,this.elem),this.elem=p,0==this.elem.children.length?this.$elem.parentNode&&this.ui.removeElement(this.$elem):this.$elem.parentNode||this.ui.addElement(this.$elem)},t}();e.StatusWindow=p},function(t,e,n){"use strict";var i=n(7),o=n(1),r=function(){function t(t,e,n){var o=this;this.ui=t,this.scrollSpeed=e,this.viewport=n,this.dragging=!1,t.addEventListener("dragstart",function(t){t.button===i.MouseButton.Right&&(o.lastMousePos=t.pos.clone(),o.dragging=!0)}),t.addEventListener("dragend",function(t){t.button===i.MouseButton.Right&&(o.dragging=!1)})}return t.prototype.update=function(t,e){var n=this.ui.mousePosition();if(n){if(this.dragging)this.viewport.pos.add(n.clone().subtract(this.lastMousePos));else{var i=new o.Vec2(0,0),r=n.x/this.ui.canvasWidth(),s=n.y/this.ui.canvasHeight();r<.1?i.x=Math.pow(o.lerp(1,0,r/.1),2):r>.9&&(i.x=-Math.pow(o.lerp(0,1,(r-.9)/.1),2)),s<.1?i.y=Math.pow(o.lerp(1,0,s/.1),2):s>.9&&(i.y=-Math.pow(o.lerp(0,1,(s-.9)/.1),2)),this.viewport.pos.add(i.multiply(this.scrollSpeed*t))}this.lastMousePos=n.clone()}},t}();e.ViewportController=r},function(t,e,n){"use strict";function i(t){for(var e=t.length-1;e>0;--e){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}return t}e.shuffle=i},function(t,e,n){"use strict";function i(t,e,n){t.setAttribute(e,n)}function o(t,e){Object.keys(e).forEach(function(n){return i(t,n,e[n])})}function r(t,e,n){t.removeAttribute(e)}function s(t,e,n,o){n?o&&o===n||i(t,e,n):r(t,e,o)}function a(t,e,n){void 0===n&&(n={});var i=Object.assign({},e,n);Object.keys(i).forEach(function(i){return s(t,i,e[i],n[i])})}function c(t){return void 0!==t.type}function u(t){if("string"==typeof t)return document.createTextNode(t);var e=document.createElement(t.type);return o(e,t.props),t.children.map(u).forEach(function(t){return e.appendChild(t)}),e}function h(t,e){return typeof t!=typeof e||"string"==typeof t&&t!==e||t.type!==e.type}function l(t,e,n){for(var i=0;i<Math.min(e.children.length,n.children.length);++i)h(e.children[i],n.children[i])?t.replaceChild(u(e.children[i]),t.childNodes[i]):c(e.children[i])&&(a(t.childNodes[i],e.children[i].props,n.children[i].props),l(t.childNodes[i],e.children[i],n.children[i]));if(n.children.length>e.children.length)for(var i=n.children.length-1;i>=e.children.length;--i)t.removeChild(t.childNodes[i]);else if(e.children.length>n.children.length)for(var i=n.children.length;i<e.children.length;++i)t.appendChild(u(e.children[i]))}var p=function(){function t(t,e,n){this.type=t,this.props=e,this.children=n}return t.create=function(t,e,n){return{type:t,props:e,children:n}},t}();e.VdomElement=p,e.createElement=u,e.updateElementChildren=l},function(t,e,n){"use strict";var i=n(14),o=n(10);n(15);var r=document.getElementById("content"),s=document.createElement("canvas");r.addEventListener("contextmenu",function(t){t.preventDefault()});var a=function(){s.width=window.innerWidth,s.height=window.innerHeight};a(),window.addEventListener("resize",a),r.appendChild(s);var c=new o.Renderer(s);new i.Game(r,s,c).start(60)}]);